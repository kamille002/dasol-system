<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¸ì‚¬ì¹´ë“œ ê´€ë¦¬ - ë‹¤ì†”ë¬¼í™˜ê²½ì—°êµ¬ì†Œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            background: #f8f9fa;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 28px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: white;
            color: #667eea;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .employee-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .employee-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .employee-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .employee-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .employee-photo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            overflow: hidden;
        }

        .employee-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .employee-info h3 {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .employee-info p {
            color: #6b7280;
            font-size: 14px;
        }

        .employee-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 13px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            color: #6b7280;
            font-size: 12px;
            margin-bottom: 3px;
        }

        .detail-value {
            font-weight: 600;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-active {
            background: #d1fae5;
            color: #065f46;
        }

        .status-inactive {
            background: #fee2e2;
            color: #991b1b;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 25px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-size: 24px;
        }

        .modal-body {
            padding: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #374151;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .photo-upload {
            text-align: center;
            padding: 20px;
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .photo-upload:hover {
            border-color: #667eea;
            background: #f3f4f6;
        }

        .photo-preview {
            width: 150px;
            height: 150px;
            margin: 0 auto 15px;
            border-radius: 50%;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            overflow: hidden;
        }

        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .modal-footer {
            padding: 20px 25px;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .search-box {
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #6b7280;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            color: #1f2937;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }

            .employee-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ’³ ì¸ì‚¬ì¹´ë“œ ê´€ë¦¬</h1>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-success" onclick="openModal()">+ ì‹ ê·œ ë“±ë¡</button>
                <button class="btn btn-primary" onclick="history.back()">â† ë’¤ë¡œ</button>
                <button class="btn btn-primary" onclick="window.location.href='../dashboard-tabs.html'">ğŸ  ëŒ€ì‹œë³´ë“œ</button>
            </div>
        </div>

        <div class="card">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="ğŸ” ì´ë¦„, ë¶€ì„œ, ì§ê¸‰ìœ¼ë¡œ ê²€ìƒ‰..." onkeyup="searchEmployees()">
            </div>

            <div id="employeeList" class="employee-grid"></div>
        </div>
    </div>

    <!-- ëª¨ë‹¬ -->
    <div id="employeeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">ì‹ ê·œ ì§ì› ë“±ë¡</h2>
                <button class="close-btn" onclick="closeModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="employeeForm">
                    <input type="hidden" id="employeeId">

                    <!-- ê·¼ë¡œê³„ì•½ì„œì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸° -->
                    <div class="form-group">
                        <label>ê·¼ë¡œê³„ì•½ì„œì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸° (ì„ íƒì‚¬í•­)</label>
                        <select id="contractSelect" onchange="loadFromContract()">
                            <option value="">-- ì‹ ê·œ ì‘ì„± ë˜ëŠ” ê³„ì•½ì„œ ì„ íƒ --</option>
                        </select>
                    </div>

                    <!-- ì‚¬ì§„ ì—…ë¡œë“œ -->
                    <div class="form-group">
                        <label>ì‚¬ì§„</label>
                        <div class="photo-upload" onclick="document.getElementById('photoInput').click()">
                            <div class="photo-preview" id="photoPreview">
                                ğŸ‘¤
                            </div>
                            <p style="color: #6b7280;">í´ë¦­í•˜ì—¬ ì‚¬ì§„ ì—…ë¡œë“œ</p>
                            <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">
                        </div>
                    </div>

                    <!-- ê¸°ë³¸ ì •ë³´ -->
                    <div class="grid-2">
                        <div class="form-group">
                            <label>ì„±ëª… *</label>
                            <input type="text" id="name" required>
                        </div>
                        <div class="form-group">
                            <label>ìƒë…„ì›”ì¼ *</label>
                            <input type="date" id="birthDate" required>
                        </div>
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label>ì…ì‚¬ì¼ *</label>
                            <input type="date" id="joinDate" required>
                        </div>
                        <div class="form-group">
                            <label>ì‹ ì…/ê²½ë ¥ *</label>
                            <select id="employmentType" required onchange="toggleCareerFields()">
                                <option value="">ì„ íƒ</option>
                                <option value="ì‹ ì…">ì‹ ì…</option>
                                <option value="ê²½ë ¥">ê²½ë ¥</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid-2" id="careerFields" style="display: none;">
                        <div class="form-group">
                            <label>ì…ì‚¬ ì‹œ ì§ê¸‰</label>
                            <select id="position">
                                <option value="">ì„ íƒ</option>
                                <option value="ì‚¬ì›">ì‚¬ì›</option>
                                <option value="ì£¼ì„">ì£¼ì„</option>
                                <option value="ëŒ€ë¦¬">ëŒ€ë¦¬</option>
                                <option value="ê³¼ì¥">ê³¼ì¥</option>
                                <option value="ë¶€ì¥">ë¶€ì¥</option>
                                <option value="ì‹¤ì¥">ì‹¤ì¥</option>
                                <option value="ì´ì‚¬">ì´ì‚¬</option>
                                <option value="ëŒ€í‘œì´ì‚¬">ëŒ€í‘œì´ì‚¬</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>í˜„ì¬ ì§ê¸‰</label>
                            <select id="currentPosition">
                                <option value="">ì„ íƒ</option>
                                <option value="ì‚¬ì›">ì‚¬ì›</option>
                                <option value="ì£¼ì„">ì£¼ì„</option>
                                <option value="ëŒ€ë¦¬">ëŒ€ë¦¬</option>
                                <option value="ê³¼ì¥">ê³¼ì¥</option>
                                <option value="ë¶€ì¥">ë¶€ì¥</option>
                                <option value="ì‹¤ì¥">ì‹¤ì¥</option>
                                <option value="ì´ì‚¬">ì´ì‚¬</option>
                                <option value="ëŒ€í‘œì´ì‚¬">ëŒ€í‘œì´ì‚¬</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ë¶€ì„œ *</label>
                        <select id="department" required>
                            <option value="">ì„ íƒ</option>
                            <option value="ì˜ì—…1íŒ€">ì˜ì—…1íŒ€</option>
                            <option value="ì˜ì—…2íŒ€">ì˜ì—…2íŒ€</option>
                            <option value="ì´ë¬´íŒ€">ì´ë¬´íŒ€</option>
                            <option value="ë¶„ì„íŒ€">ë¶„ì„íŒ€</option>
                            <option value="ìˆ˜ì§ˆìê°€ì¸¡ì •íŒ€">ìˆ˜ì§ˆìê°€ì¸¡ì •íŒ€</option>
                            <option value="ë¨¹ëŠ”ë¬¼ê²€ì‚¬íŒ€">ë¨¹ëŠ”ë¬¼ê²€ì‚¬íŒ€</option>
                        </select>
                    </div>

                    <!-- ì—°ë½ì²˜ -->
                    <div class="grid-2">
                        <div class="form-group">
                            <label>ì—°ë½ì²˜ *</label>
                            <input type="tel" id="phone" required placeholder="010-1234-5678">
                        </div>
                        <div class="form-group">
                            <label>ì´ë©”ì¼</label>
                            <input type="email" id="email" placeholder="example@dasol.co.kr">
                        </div>
                    </div>

                    <!-- ì£¼ì†Œ -->
                    <div class="form-group">
                        <label>ì£¼ì†Œ</label>
                        <input type="text" id="address" placeholder="ì„œìš¸ì‹œ ê°•ë‚¨êµ¬...">
                    </div>

                    <!-- í•™ë ¥ -->
                    <div class="form-group">
                        <label>ìµœì¢…í•™ë ¥</label>
                        <input type="text" id="education" placeholder="ì˜ˆ: ì„œìš¸ëŒ€í•™êµ í™˜ê²½ê³µí•™ê³¼ ì¡¸ì—…">
                    </div>

                    <!-- ê²½ë ¥ ì‚¬í•­ -->
                    <div class="form-group">
                        <label>ì´ì „ ê²½ë ¥ ì‚¬í•­</label>
                        <div id="careerList"></div>
                        <button type="button" class="btn btn-secondary" onclick="addCareer()" style="margin-top: 10px;">+ ê²½ë ¥ ì¶”ê°€</button>
                    </div>

                    <!-- ì¬ì§ ìƒíƒœ -->
                    <div class="form-group">
                        <label>ì¬ì§ ìƒíƒœ *</label>
                        <select id="status" required>
                            <option value="ì¬ì§ì¤‘">ì¬ì§ì¤‘</option>
                            <option value="í‡´ì‚¬">í‡´ì‚¬</option>
                        </select>
                    </div>

                    <!-- í‡´ì‚¬ì¼ -->
                    <div class="form-group" id="resignDateGroup" style="display: none;">
                        <label>í‡´ì‚¬ì¼</label>
                        <input type="date" id="resignDate">
                    </div>

                    <!-- ë¹„ê³  -->
                    <div class="form-group">
                        <label>ë¹„ê³ </label>
                        <textarea id="notes" placeholder="íŠ¹ì´ì‚¬í•­ ê¸°ì¬"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">ì·¨ì†Œ</button>
                <button class="btn btn-success" onclick="saveEmployee()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        let employees = [];
        let currentPhoto = null;
        let editingId = null;
        let careers = []; // ê²½ë ¥ ëª©ë¡

        // í˜ì´ì§€ ë¡œë“œ ì‹œ
        window.addEventListener('load', () => {
            loadEmployees();
            loadContracts();
            renderEmployees();
        });

        // ê·¼ë¡œê³„ì•½ì„œ ëª©ë¡ ë¡œë“œ
        function loadContracts() {
            const contracts = JSON.parse(localStorage.getItem('dasol_contracts') || '[]');
            const select = document.getElementById('contractSelect');
            
            contracts.forEach(contract => {
                const option = document.createElement('option');
                option.value = contract.id;
                option.textContent = `${contract.employeeName} - ${contract.startDate}`;
                select.appendChild(option);
            });
        }

        // ê·¼ë¡œê³„ì•½ì„œì—ì„œ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadFromContract() {
            const contractId = document.getElementById('contractSelect').value;
            if (!contractId) return;

            const contracts = JSON.parse(localStorage.getItem('dasol_contracts') || '[]');
            const contract = contracts.find(c => c.id === contractId);
            if (!contract) return;

            // ê¸°ë³¸ ì •ë³´ ìë™ ì±„ìš°ê¸°
            document.getElementById('name').value = contract.employeeName;
            document.getElementById('joinDate').value = contract.startDate;
            document.getElementById('department').value = contract.department || '';
            
            // ê²½ë ¥/ì‹ ì… íŒë‹¨ (ê³„ì•½ì„œì— ì§ê¸‰ì´ ìˆìœ¼ë©´ ê²½ë ¥)
            if (contract.initialPosition) {
                document.getElementById('employmentType').value = 'ê²½ë ¥';
                document.getElementById('careerFields').style.display = 'grid';
                document.getElementById('position').value = contract.initialPosition;
                document.getElementById('currentPosition').value = contract.initialPosition;
            } else {
                document.getElementById('employmentType').value = 'ì‹ ì…';
            }

            alert('âœ… ê·¼ë¡œê³„ì•½ì„œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!\në‚˜ë¨¸ì§€ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        }

        // ê²½ë ¥ ì¶”ê°€
        function addCareer() {
            const career = {
                id: Date.now(),
                company: '',
                position: '',
                department: '',
                startDate: '',
                endDate: '',
                duties: ''
            };
            careers.push(career);
            renderCareers();
        }

        // ê²½ë ¥ ì‚­ì œ
        function removeCareer(id) {
            careers = careers.filter(c => c.id !== id);
            renderCareers();
        }

        // ê²½ë ¥ ë Œë”ë§
        function renderCareers() {
            const container = document.getElementById('careerList');
            if (careers.length === 0) {
                container.innerHTML = '<p style="color: #6b7280; text-align: center; padding: 20px;">ë“±ë¡ëœ ê²½ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            container.innerHTML = careers.map((career, index) => `
                <div style="border: 1px solid #e5e7eb; border-radius: 8px; padding: 15px; margin-bottom: 10px; background: #f9fafb;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <strong>ê²½ë ¥ ${index + 1}</strong>
                        <button type="button" onclick="removeCareer(${career.id})" style="background: #ef4444; color: white; border: none; border-radius: 4px; padding: 4px 12px; cursor: pointer;">ì‚­ì œ</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <input type="text" placeholder="íšŒì‚¬ëª…" value="${career.company}" onchange="careers[${index}].company = this.value" style="padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;">
                        <input type="text" placeholder="ì§ê¸‰" value="${career.position}" onchange="careers[${index}].position = this.value" style="padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;">
                        <input type="text" placeholder="ë¶€ì„œ" value="${career.department}" onchange="careers[${index}].department = this.value" style="padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;">
                        <input type="text" placeholder="ë‹´ë‹¹ ì—…ë¬´" value="${career.duties}" onchange="careers[${index}].duties = this.value" style="padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;">
                        <input type="date" placeholder="ì…ì‚¬ì¼" value="${career.startDate}" onchange="careers[${index}].startDate = this.value" style="padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;">
                        <input type="date" placeholder="í‡´ì‚¬ì¼" value="${career.endDate}" onchange="careers[${index}].endDate = this.value" style="padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;">
                    </div>
                </div>
            `).join('');
        }

        // ì§ì› ë°ì´í„° ë¡œë“œ
        function loadEmployees() {
            const saved = localStorage.getItem('dasol_employees');
            if (saved) {
                employees = JSON.parse(saved);
            }
        }

        // ì§ì› ëª©ë¡ ë Œë”ë§
        function renderEmployees(filter = '') {
            const container = document.getElementById('employeeList');
            
            let filtered = employees;
            if (filter) {
                filtered = employees.filter(emp => 
                    emp.name.includes(filter) ||
                    emp.department.includes(filter) ||
                    (emp.currentPosition && emp.currentPosition.includes(filter))
                );
            }

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <div class="empty-state-icon">ğŸ‘¥</div>
                        <h3>ë“±ë¡ëœ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p style="margin-top: 10px;">ì‹ ê·œ ë“±ë¡ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì§ì›ì„ ì¶”ê°€í•˜ì„¸ìš”.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filtered.map(emp => `
                <div class="employee-card" onclick="editEmployee('${emp.id}')">
                    <div class="employee-header">
                        <div class="employee-photo">
                            ${emp.photo ? `<img src="${emp.photo}" alt="${emp.name}">` : 'ğŸ‘¤'}
                        </div>
                        <div class="employee-info">
                            <h3>${emp.name}</h3>
                            <p>${emp.department} ${emp.currentPosition || emp.position || ''}</p>
                        </div>
                    </div>
                    <div class="employee-details">
                        <div class="detail-item">
                            <span class="detail-label">ì…ì‚¬ì¼</span>
                            <span class="detail-value">${emp.joinDate}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">êµ¬ë¶„</span>
                            <span class="detail-value">${emp.employmentType}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">ì—°ë½ì²˜</span>
                            <span class="detail-value">${emp.phone}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">ìƒíƒœ</span>
                            <span class="status-badge ${emp.status === 'ì¬ì§ì¤‘' ? 'status-active' : 'status-inactive'}">
                                ${emp.status}
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ê²€ìƒ‰
        function searchEmployees() {
            const filter = document.getElementById('searchInput').value;
            renderEmployees(filter);
        }

        // ëª¨ë‹¬ ì—´ê¸°
        function openModal() {
            editingId = null;
            document.getElementById('modalTitle').textContent = 'ì‹ ê·œ ì§ì› ë“±ë¡';
            document.getElementById('employeeForm').reset();
            document.getElementById('photoPreview').innerHTML = 'ğŸ‘¤';
            currentPhoto = null;
            document.getElementById('careerFields').style.display = 'none';
            document.getElementById('resignDateGroup').style.display = 'none';
            document.getElementById('employeeModal').classList.add('active');
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal() {
            document.getElementById('employeeModal').classList.remove('active');
        }

        // ì§ì› ìˆ˜ì •
        function editEmployee(id) {
            const employee = employees.find(e => e.id === id);
            if (!employee) return;

            editingId = id;
            document.getElementById('modalTitle').textContent = 'ì§ì› ì •ë³´ ìˆ˜ì •';
            
            // í¼ì— ë°ì´í„° ì±„ìš°ê¸°
            document.getElementById('employeeId').value = employee.id;
            document.getElementById('name').value = employee.name;
            document.getElementById('birthDate').value = employee.birthDate;
            document.getElementById('joinDate').value = employee.joinDate;
            document.getElementById('employmentType').value = employee.employmentType;
            document.getElementById('department').value = employee.department;
            document.getElementById('phone').value = employee.phone;
            document.getElementById('email').value = employee.email || '';
            document.getElementById('address').value = employee.address || '';
            document.getElementById('education').value = employee.education || '';
            document.getElementById('status').value = employee.status;
            document.getElementById('notes').value = employee.notes || '';

            if (employee.employmentType === 'ê²½ë ¥') {
                document.getElementById('careerFields').style.display = 'grid';
                document.getElementById('position').value = employee.position || '';
                document.getElementById('currentPosition').value = employee.currentPosition || '';
            }

            if (employee.status === 'í‡´ì‚¬') {
                document.getElementById('resignDateGroup').style.display = 'block';
                document.getElementById('resignDate').value = employee.resignDate || '';
            }

            if (employee.photo) {
                document.getElementById('photoPreview').innerHTML = `<img src="${employee.photo}" alt="${employee.name}">`;
                currentPhoto = employee.photo;
            }

            document.getElementById('employeeModal').classList.add('active');
        }

        // ê²½ë ¥/ì‹ ì… í† ê¸€
        function toggleCareerFields() {
            const type = document.getElementById('employmentType').value;
            const careerFields = document.getElementById('careerFields');
            
            if (type === 'ê²½ë ¥') {
                careerFields.style.display = 'grid';
            } else {
                careerFields.style.display = 'none';
                document.getElementById('position').value = '';
                document.getElementById('currentPosition').value = '';
            }
        }

        // ì¬ì§ ìƒíƒœ ë³€ê²½
        document.getElementById('status').addEventListener('change', function() {
            const resignDateGroup = document.getElementById('resignDateGroup');
            if (this.value === 'í‡´ì‚¬') {
                resignDateGroup.style.display = 'block';
            } else {
                resignDateGroup.style.display = 'none';
                document.getElementById('resignDate').value = '';
            }
        });

        // ì‚¬ì§„ ì—…ë¡œë“œ
        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                currentPhoto = e.target.result;
                document.getElementById('photoPreview').innerHTML = `<img src="${currentPhoto}" alt="Preview">`;
            };
            reader.readAsDataURL(file);
        }

        // ì €ì¥
        function saveEmployee() {
            const form = document.getElementById('employeeForm');
            if (!form.checkValidity()) {
                alert('âš ï¸ í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            const employeeData = {
                id: editingId || `EMP-${Date.now()}`,
                name: document.getElementById('name').value,
                birthDate: document.getElementById('birthDate').value,
                joinDate: document.getElementById('joinDate').value,
                employmentType: document.getElementById('employmentType').value,
                position: document.getElementById('position').value,
                currentPosition: document.getElementById('currentPosition').value,
                department: document.getElementById('department').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                address: document.getElementById('address').value,
                education: document.getElementById('education').value,
                careers: careers, // ê²½ë ¥ ì •ë³´ ì¶”ê°€
                status: document.getElementById('status').value,
                resignDate: document.getElementById('resignDate').value,
                notes: document.getElementById('notes').value,
                photo: currentPhoto,
                createdAt: editingId ? employees.find(e => e.id === editingId).createdAt : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            if (editingId) {
                // ìˆ˜ì •
                const index = employees.findIndex(e => e.id === editingId);
                employees[index] = employeeData;
            } else {
                // ì‹ ê·œ
                employees.push(employeeData);
            }

            // ì €ì¥
            localStorage.setItem('dasol_employees', JSON.stringify(employees));

            alert('âœ… ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            closeModal();
            renderEmployees();
        }
    </script>
</body>
</html>
