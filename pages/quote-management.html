<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Í≤¨Ï†ÅÏÑú Í¥ÄÎ¶¨ - Îã§ÏÜîÎ¨ºÌôòÍ≤ΩÏó∞Íµ¨ÏÜå</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
            background: #f3f4f6;
            padding: 20px;
        }
        .header {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header h1 {
            font-size: 24px;
            color: #111827;
        }
        .header-actions {
            display: flex;
            gap: 12px;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-primary {
            background: #667eea;
            color: white;
        }
        .btn-success {
            background: #10b981;
            color: white;
        }
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .content {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 24px;
        }
        
        .filter-section {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }
        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        th {
            background: #f9fafb;
            font-weight: 600;
            color: #374151;
        }
        tr:hover {
            background: #f9fafb;
        }
        
        .status-badge {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 700;
        }
        .status-draft {
            background: #e5e7eb;
            color: #6b7280;
        }
        .status-sent {
            background: #dbeafe;
            color: #1e40af;
        }
        .status-converted {
            background: #d1fae5;
            color: #065f46;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 4px;
        }
        
        /* Î™®Îã¨ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            overflow-y: auto;
        }
        .modal.show {
            display: flex;
        }
        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 32px;
            max-width: 900px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        .modal-header h2 {
            font-size: 20px;
            font-weight: 700;
        }
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #6b7280;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 16px;
        }
        .form-group {
            margin-bottom: 16px;
        }
        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .items-section {
            margin: 24px 0;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
        }
        .item-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr auto;
            gap: 8px;
            margin-bottom: 8px;
            align-items: center;
        }
        .item-row input {
            padding: 8px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
        }
        .remove-item {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .total-section {
            background: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            margin-top: 16px;
        }
        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }
        .total-row.grand-total {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
            border-top: 2px solid #e5e7eb;
            padding-top: 8px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìÑ Í≤¨Ï†ÅÏÑú Í¥ÄÎ¶¨</h1>
        <div class="header-actions">
            <button class="btn btn-primary" onclick="openQuoteModal()">+ Í≤¨Ï†ÅÏÑú ÏûëÏÑ±</button>
            <button class="btn btn-primary" onclick="history.back()">‚Üê Îí§Î°ú</button>
            <button class="btn btn-secondary" onclick="window.location.href=\'../dashboard-tabs.html\'">üè† ÎåÄÏãúÎ≥¥Îìú</button>
        </div>
    </div>

    <div class="content">
        <div class="filter-section">
            <button class="filter-btn active" onclick="filterQuotes('all')">Ï†ÑÏ≤¥</button>
            <button class="filter-btn" onclick="filterQuotes('draft')">ÏûÑÏãúÏ†ÄÏû•</button>
            <button class="filter-btn" onclick="filterQuotes('sent')">Î∞úÏÜ°ÏôÑÎ£å</button>
            <button class="filter-btn" onclick="filterQuotes('converted')">ÏùòÎ¢∞Ï†ÑÌôò</button>
        </div>

        <table id="quoteTable">
            <thead>
                <tr>
                    <th>Í≤¨Ï†ÅÎ≤àÌò∏</th>
                    <th>ÏàòÏã†Ï≤ò</th>
                    <th>ÏûëÏÑ±Ïùº</th>
                    <th>Í∏àÏï°</th>
                    <th>ÏÉÅÌÉú</th>
                    <th>ÏûëÏóÖ</th>
                </tr>
            </thead>
            <tbody id="quoteTableBody">
                <!-- JavaScriptÎ°ú ÎèôÏ†Å ÏÉùÏÑ± -->
            </tbody>
        </table>
    </div>

    <!-- Í≤¨Ï†ÅÏÑú ÏûëÏÑ± Î™®Îã¨ -->
    <div id="quoteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Í≤¨Ï†ÅÏÑú ÏûëÏÑ±</h2>
                <button class="close-btn" onclick="closeQuoteModal()">√ó</button>
            </div>

            <form id="quoteForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>Í≤¨Ï†ÅÎ≤àÌò∏ (ÏûêÎèôÏÉùÏÑ±)</label>
                        <input type="text" id="quoteNumber" readonly>
                    </div>
                    <div class="form-group">
                        <label>ÏûëÏÑ±Ïùº</label>
                        <input type="date" id="quoteDate" required>
                    </div>
                </div>

                <h3 style="margin: 24px 0 16px 0; font-size: 16px;">ÏàòÏã†Ï≤ò Ï†ïÎ≥¥</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>ÏàòÏã†Ï≤òÎ™Ö *</label>
                        <input type="text" id="clientName" placeholder="(Ï£º)ÎèÑÏÑúÏ∂úÌåêÎ≥¥Î¶¨" required>
                    </div>
                    <div class="form-group">
                        <label>Îã¥ÎãπÏûê</label>
                        <input type="text" id="clientContact" placeholder="ÌôçÍ∏∏Îèô">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ï†ÑÌôîÎ≤àÌò∏</label>
                        <input type="text" id="clientPhone" placeholder="031-950-9511">
                    </div>
                    <div class="form-group">
                        <label>Ïù¥Î©îÏùº</label>
                        <input type="email" id="clientEmail" placeholder="client@example.com">
                    </div>
                </div>

                <h3 style="margin: 24px 0 16px 0; font-size: 16px;">Í≤¨Ï†Å ÎÇ¥Ïó≠</h3>
                <div class="items-section">
                    <div id="itemsContainer">
                        <div class="item-row">
                            <input type="text" placeholder="ÌíàÎ™Ö (Ïòà: ÏàòÏßàÍ≤ÄÏÇ¨ ÏÉùÌôúÏö©Ïàò20Ìï≠Î™©)" class="item-name" required>
                            <input type="number" placeholder="Îã®Í∞Ä" class="item-price" min="0" onchange="calculateTotal()" required>
                            <input type="number" placeholder="ÏàòÎüâ" class="item-quantity" min="1" value="1" onchange="calculateTotal()" required>
                            <input type="number" placeholder="Í∏àÏï°" class="item-amount" readonly>
                            <button type="button" class="remove-item" onclick="removeItem(this)" style="display: none;">ÏÇ≠Ï†ú</button>
                        </div>
                    </div>
                    <button type="button" class="btn btn-success" onclick="addItem()" style="margin-top: 8px;">+ Ìï≠Î™© Ï∂îÍ∞Ä</button>
                </div>

                <div class="total-section">
                    <div class="total-row">
                        <span>Í∏àÏï°:</span>
                        <span id="subtotal">0Ïõê</span>
                    </div>
                    <div class="total-row">
                        <span>Î∂ÄÍ∞ÄÏÑ∏ (10%):</span>
                        <span id="vat">0Ïõê</span>
                    </div>
                    <div class="total-row grand-total">
                        <span>Ìï©Í≥Ñ:</span>
                        <span id="grandTotal">0Ïõê</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>ÎπÑÍ≥†</label>
                    <textarea id="notes" rows="3" placeholder="ÌäπÏù¥ÏÇ¨Ìï≠ ÏûÖÎ†•"></textarea>
                </div>

                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <button type="button" class="btn btn-secondary" onclick="saveQuote('draft')" style="flex: 1;">ÏûÑÏãúÏ†ÄÏû•</button>
                    <button type="submit" class="btn btn-primary" style="flex: 1;">Ï†ÄÏû• & PDF ÏÉùÏÑ±</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let quotes = [];
        let currentFilter = 'all';
        let editMode = false;
        let editId = null;

        function init() {
            quotes = JSON.parse(localStorage.getItem('dasol_quotes') || '[]');
            renderQuoteTable();
            
            // Í≤¨Ï†ÅÎ≤àÌò∏ ÏûêÎèô ÏÉùÏÑ±
            document.getElementById('quoteDate').value = new Date().toISOString().split('T')[0];
            generateQuoteNumber();

            // Ìèº Ï†úÏ∂ú Ïù¥Î≤§Ìä∏
            document.getElementById('quoteForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveQuote('sent');
            });
        }

        function generateQuoteNumber() {
            const today = new Date();
            const year = today.getFullYear().toString().slice(2);
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const existingQuotes = quotes.filter(q => 
                q.quoteNumber && q.quoteNumber.startsWith(`Í≤¨Ï†Å${year}${month}`)
            );
            const sequence = String(existingQuotes.length + 1).padStart(4, '0');
            document.getElementById('quoteNumber').value = `Í≤¨Ï†Å${year}${month}-${sequence}`;
        }

        function openQuoteModal() {
            editMode = false;
            editId = null;
            document.getElementById('quoteModal').classList.add('show');
            document.getElementById('quoteForm').reset();
            generateQuoteNumber();
            document.getElementById('quoteDate').value = new Date().toISOString().split('T')[0];
            
            // Ï≤´ Ìï≠Î™© Ï¥àÍ∏∞Ìôî
            const itemsContainer = document.getElementById('itemsContainer');
            itemsContainer.innerHTML = `
                <div class="item-row">
                    <input type="text" placeholder="ÌíàÎ™Ö (Ïòà: ÏàòÏßàÍ≤ÄÏÇ¨ ÏÉùÌôúÏö©Ïàò20Ìï≠Î™©)" class="item-name" required>
                    <input type="number" placeholder="Îã®Í∞Ä" class="item-price" min="0" onchange="calculateTotal()" required>
                    <input type="number" placeholder="ÏàòÎüâ" class="item-quantity" min="1" value="1" onchange="calculateTotal()" required>
                    <input type="number" placeholder="Í∏àÏï°" class="item-amount" readonly>
                    <button type="button" class="remove-item" onclick="removeItem(this)" style="display: none;">ÏÇ≠Ï†ú</button>
                </div>
            `;
            calculateTotal();
        }

        function closeQuoteModal() {
            document.getElementById('quoteModal').classList.remove('show');
        }

        function addItem() {
            const container = document.getElementById('itemsContainer');
            const newRow = document.createElement('div');
            newRow.className = 'item-row';
            newRow.innerHTML = `
                <input type="text" placeholder="ÌíàÎ™Ö" class="item-name" required>
                <input type="number" placeholder="Îã®Í∞Ä" class="item-price" min="0" onchange="calculateTotal()" required>
                <input type="number" placeholder="ÏàòÎüâ" class="item-quantity" min="1" value="1" onchange="calculateTotal()" required>
                <input type="number" placeholder="Í∏àÏï°" class="item-amount" readonly>
                <button type="button" class="remove-item" onclick="removeItem(this)">ÏÇ≠Ï†ú</button>
            `;
            container.appendChild(newRow);
            updateRemoveButtons();
        }

        function removeItem(btn) {
            btn.closest('.item-row').remove();
            calculateTotal();
            updateRemoveButtons();
        }

        function updateRemoveButtons() {
            const rows = document.querySelectorAll('.item-row');
            rows.forEach((row, index) => {
                const removeBtn = row.querySelector('.remove-item');
                if (rows.length === 1) {
                    removeBtn.style.display = 'none';
                } else {
                    removeBtn.style.display = 'block';
                }
            });
        }

        function calculateTotal() {
            const rows = document.querySelectorAll('.item-row');
            let subtotal = 0;

            rows.forEach(row => {
                const price = parseFloat(row.querySelector('.item-price').value) || 0;
                const quantity = parseFloat(row.querySelector('.item-quantity').value) || 0;
                const amount = price * quantity;
                row.querySelector('.item-amount').value = amount;
                subtotal += amount;
            });

            const vat = Math.round(subtotal * 0.1);
            const grandTotal = subtotal + vat;

            document.getElementById('subtotal').textContent = subtotal.toLocaleString() + 'Ïõê';
            document.getElementById('vat').textContent = vat.toLocaleString() + 'Ïõê';
            document.getElementById('grandTotal').textContent = grandTotal.toLocaleString() + 'Ïõê';
        }

        function saveQuote(status) {
            const rows = document.querySelectorAll('.item-row');
            const items = [];
            let subtotal = 0;

            rows.forEach(row => {
                const name = row.querySelector('.item-name').value;
                const price = parseFloat(row.querySelector('.item-price').value) || 0;
                const quantity = parseFloat(row.querySelector('.item-quantity').value) || 0;
                const amount = price * quantity;
                
                items.push({ name, price, quantity, amount });
                subtotal += amount;
            });

            const vat = Math.round(subtotal * 0.1);
            const grandTotal = subtotal + vat;

            const quote = {
                id: editMode ? editId : 'Q' + Date.now(),
                quoteNumber: document.getElementById('quoteNumber').value,
                quoteDate: document.getElementById('quoteDate').value,
                clientName: document.getElementById('clientName').value,
                clientContact: document.getElementById('clientContact').value,
                clientPhone: document.getElementById('clientPhone').value,
                clientEmail: document.getElementById('clientEmail').value,
                items: items,
                subtotal: subtotal,
                vat: vat,
                grandTotal: grandTotal,
                notes: document.getElementById('notes').value,
                status: status,
                createdAt: editMode ? quotes.find(q => q.id === editId).createdAt : new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                createdBy: JSON.parse(localStorage.getItem('dasol_session') || '{}').name || 'Í¥ÄÎ¶¨Ïûê'
            };

            if (editMode) {
                quotes = quotes.map(q => q.id === editId ? quote : q);
            } else {
                quotes.push(quote);
            }

            localStorage.setItem('dasol_quotes', JSON.stringify(quotes));
            
            if (status === 'sent') {
                generateQuotePDF(quote);
            }
            
            closeQuoteModal();
            renderQuoteTable();
            alert(status === 'draft' ? 'ÏûÑÏãúÏ†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.' : 'Í≤¨Ï†ÅÏÑúÍ∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§.');
        }

        function renderQuoteTable() {
            const tbody = document.getElementById('quoteTableBody');
            
            let filtered = quotes;
            if (currentFilter !== 'all') {
                filtered = quotes.filter(q => q.status === currentFilter);
            }

            if (filtered.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: #6b7280;">
                            Îì±Î°ùÎêú Í≤¨Ï†ÅÏÑúÍ∞Ä ÏóÜÏäµÎãàÎã§
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = filtered.map(quote => `
                <tr>
                    <td>${quote.quoteNumber}</td>
                    <td>${quote.clientName}</td>
                    <td>${formatDate(quote.quoteDate)}</td>
                    <td style="font-weight: 700; color: #667eea;">${quote.grandTotal.toLocaleString()}Ïõê</td>
                    <td>
                        <span class="status-badge status-${quote.status}">
                            ${quote.status === 'draft' ? 'ÏûÑÏãúÏ†ÄÏû•' : quote.status === 'sent' ? 'Î∞úÏÜ°ÏôÑÎ£å' : 'ÏùòÎ¢∞Ï†ÑÌôò'}
                        </span>
                    </td>
                    <td>
                        <button class="btn-small" style="background: #667eea; color: white;" onclick="viewQuotePDF('${quote.id}')">PDF</button>
                        <button class="btn-small" style="background: #10b981; color: white;" onclick="convertToRequest('${quote.id}')">ÏùòÎ¢∞Ï†ÑÌôò</button>
                        <button class="btn-small" style="background: #ef4444; color: white;" onclick="deleteQuote('${quote.id}')">ÏÇ≠Ï†ú</button>
                    </td>
                </tr>
            `).join('');
        }

        function filterQuotes(filter) {
            currentFilter = filter;
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderQuoteTable();
        }

        function deleteQuote(id) {
            if (!confirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            quotes = quotes.filter(q => q.id !== id);
            localStorage.setItem('dasol_quotes', JSON.stringify(quotes));
            renderQuoteTable();
        }

        function convertToRequest(id) {
            if (!confirm('Ïù¥ Í≤¨Ï†ÅÏÑúÎ•º ÏùòÎ¢∞ÏÑúÎ°ú Ï†ÑÌôòÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            
            const quote = quotes.find(q => q.id === id);
            quote.status = 'converted';
            localStorage.setItem('dasol_quotes', JSON.stringify(quotes));
            
            // ÏùòÎ¢∞ÏÑú ÌéòÏù¥ÏßÄÎ°ú Ïù¥ÎèôÌïòÎ©¥ÏÑú Îç∞Ïù¥ÌÑ∞ Ï†ÑÎã¨
            sessionStorage.setItem('convertedQuote', JSON.stringify(quote));
            window.location.href = 'request-register.html?fromQuote=true';
        }

        function viewQuotePDF(id) {
            const quote = quotes.find(q => q.id === id);
            generateQuotePDF(quote);
        }

        function generateQuotePDF(quote) {
            const html = `
                <!DOCTYPE html>
                <html lang="ko">
                <head>
                    <meta charset="UTF-8">
                    <title>Í≤¨Ï†ÅÏÑú - ${quote.quoteNumber}</title>
                    <style>
                        @page { size: A4; margin: 15mm; }
                        * { margin: 0; padding: 0; box-sizing: border-box; }
                        body {
                            font-family: 'Malgun Gothic', 'Noto Sans KR', sans-serif;
                            padding: 30px;
                            line-height: 1.5;
                        }
                        .title {
                            text-align: center;
                            font-size: 32px;
                            font-weight: 700;
                            margin-bottom: 40px;
                            padding-bottom: 15px;
                            border-bottom: 4px double #000;
                            letter-spacing: 8px;
                        }
                        .info-section {
                            display: grid;
                            grid-template-columns: 1fr 1fr;
                            gap: 25px;
                            margin-bottom: 40px;
                        }
                        .info-box {
                            border: 2px solid #000;
                            position: relative;
                        }
                        .info-box h3 {
                            text-align: center;
                            margin: 0;
                            padding: 12px;
                            border-bottom: 2px solid #000;
                            background: #f5f5f5;
                            font-size: 16px;
                            font-weight: 700;
                        }
                        .info-content {
                            padding: 20px;
                        }
                        .info-row {
                            display: grid;
                            grid-template-columns: 110px 1fr;
                            margin-bottom: 10px;
                            font-size: 14px;
                            line-height: 1.6;
                        }
                        .info-label {
                            font-weight: 600;
                            background: #f9f9f9;
                            padding: 6px 10px;
                            border-right: 1px solid #ddd;
                        }
                        .info-value {
                            padding: 6px 10px;
                        }
                        .stamp-container {
                            position: absolute;
                            top: 15px;
                            right: 15px;
                            width: 80px;
                            height: 80px;
                            z-index: 10;
                        }
                        .stamp-container img {
                            width: 100%;
                            height: 100%;
                            object-fit: contain;
                        }
                        .meta-info {
                            display: flex;
                            justify-content: space-between;
                            margin-bottom: 20px;
                            padding: 15px;
                            background: #f9f9f9;
                            border: 1px solid #ddd;
                            font-size: 13px;
                        }
                        .meta-info-item {
                            display: flex;
                            gap: 8px;
                        }
                        .meta-label {
                            font-weight: 600;
                        }
                        .statement {
                            text-align: center;
                            margin: 30px 0 20px 0;
                            font-size: 15px;
                            font-weight: 600;
                        }
                        table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 20px 0;
                            border: 2px solid #000;
                        }
                        th, td {
                            border: 1px solid #000;
                            padding: 12px 8px;
                            text-align: center;
                            font-size: 13px;
                        }
                        th {
                            background: #f0f0f0;
                            font-weight: 700;
                        }
                        .col-no { width: 50px; }
                        .col-item { width: 120px; }
                        .col-spec { width: auto; }
                        .col-unit { width: 70px; }
                        .col-qty { width: 70px; }
                        .col-amount { width: 120px; }
                        .total-section {
                            margin-top: 30px;
                            border: 2px solid #000;
                            padding: 20px;
                            display: flex;
                            flex-direction: column;
                            gap: 12px;
                        }
                        .total-row {
                            display: flex;
                            justify-content: space-between;
                            font-size: 14px;
                            padding: 8px 0;
                            border-bottom: 1px solid #ddd;
                        }
                        .total-row:last-child {
                            border-bottom: none;
                        }
                        .total-row .label {
                            font-weight: 600;
                        }
                        .total-row.grand {
                            font-size: 18px;
                            font-weight: 700;
                            border-top: 2px solid #000;
                            padding-top: 15px;
                            margin-top: 10px;
                            color: #667eea;
                        }
                        .footer {
                            margin-top: 50px;
                            text-align: center;
                            padding-top: 30px;
                            border-top: 2px solid #000;
                        }
                        .company-info {
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            gap: 20px;
                            margin-bottom: 15px;
                        }
                        .logo-container {
                            width: 80px;
                            height: 80px;
                        }
                        .logo-container img {
                            width: 100%;
                            height: 100%;
                            object-fit: contain;
                        }
                        .company-details {
                            text-align: left;
                            font-size: 13px;
                            line-height: 1.8;
                        }
                        .company-name {
                            font-size: 18px;
                            font-weight: 700;
                            margin-bottom: 5px;
                        }
                        @media print {
                            .no-print { display: none; }
                            body { padding: 0; }
                        }
                    </style>
                </head>
                <body>
                    <div class="title">Í≤¨ Ï†Å ÏÑú</div>
                    
                    <div class="meta-info">
                        <div class="meta-info-item">
                            <span class="meta-label">Î¨∏ÏÑúÎ≤àÌò∏:</span>
                            <span>${quote.quoteNumber}</span>
                        </div>
                        <div class="meta-info-item">
                            <span class="meta-label">Í≤¨Ï†ÅÏùºÏûê:</span>
                            <span>${new Date(quote.createdAt).toLocaleDateString('ko-KR')}</span>
                        </div>
                        <div class="meta-info-item">
                            <span class="meta-label">Ïú†Ìö®Í∏∞Í∞Ñ:</span>
                            <span>${new Date(new Date(quote.createdAt).setDate(new Date(quote.createdAt).getDate() + 30)).toLocaleDateString('ko-KR')}</span>
                        </div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-box">
                            <h3>Ïàò Ïã†</h3>
                            <div class="info-content">
                                <div class="info-row">
                                    <div class="info-label">ÏÉÅ Ìò∏</div>
                                    <div class="info-value">${quote.clientName} Í∑ÄÌïò</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Îã¥ÎãπÏûê</div>
                                    <div class="info-value">${quote.clientContact || '-'}</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Ï†Ñ Ìôî</div>
                                    <div class="info-value">${quote.clientPhone || '-'}</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Í∏à Ïï°</div>
                                    <div class="info-value" style="font-weight: 700; color: #667eea;">ÏùºÍ∏à${convertNumberToKorean(quote.grandTotal)}ÏõêÏ†ï<br>(‚Ç© ${quote.grandTotal.toLocaleString()})</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="info-box">
                            <h3>Î∞ú Ïã†</h3>
                            <div class="stamp-container">
                                <img src="../assets/stamp-transparent.png" alt="ÏÇ¨Í∞ÅÎèÑÏû•" />
                            </div>
                            <div class="info-content">
                                <div class="info-row">
                                    <div class="info-label">ÏÉÅ Ìò∏</div>
                                    <div class="info-value">(Ï£º)Îã§ÏÜîÎ¨ºÌôòÍ≤ΩÏó∞Íµ¨ÏÜå</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">ÎåÄÌëúÏù¥ÏÇ¨</div>
                                    <div class="info-value">Ïã¨ÌÉúÎ≥¥</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">ÏÇ¨ÏóÖÏûêÎ≤àÌò∏</div>
                                    <div class="info-value">214-88-95667</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Ï£º ÏÜå</div>
                                    <div class="info-value">Í≤ΩÍ∏∞ÎèÑ ÌïòÎÇ®Ïãú Ï¥àÍ¥ëÏÇ∞Îã®Î°ú 126, Ïö∞ÏùºÎπåÎî© 3Ï∏µ</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Ï†Ñ Ìôî</div>
                                    <div class="info-value">031-772-4530</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Ìå© Ïä§</div>
                                    <div class="info-value">070-8677-0553</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">Í≥ÑÏ¢åÎ≤àÌò∏</div>
                                    <div class="info-value">Íµ≠ÎØºÏùÄÌñâ 220401-04-219973</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">ÏòàÍ∏àÏ£º</div>
                                    <div class="info-value">(Ï£º)Îã§ÏÜîÎ¨ºÌôòÍ≤ΩÏó∞Íµ¨ÏÜå</div>
                                </div>
                                <div class="info-row">
                                    <div class="info-label">ÏûëÏÑ±Ïûê</div>
                                    <div class="info-value">${quote.createdBy}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="statement">ÏÉÅÍ∏∞ÏôÄ Í∞ôÏù¥ Í≤¨Ï†Å Ìï©ÎãàÎã§.</div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th class="col-no">Î≤àÌò∏</th>
                                <th class="col-item">Íµ¨Î∂Ñ</th>
                                <th class="col-spec">ÌíàÎ™Ö</th>
                                <th class="col-unit">Îã®Í∞Ä(Ïõê)</th>
                                <th class="col-qty">ÏàòÎüâ</th>
                                <th class="col-amount">Í∏àÏï°(Ïõê)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${quote.items.map((item, index) => `
                                <tr>
                                    <td>${index + 1}</td>
                                    <td>ÏàòÏßàÍ≤ÄÏÇ¨</td>
                                    <td style="text-align: left; padding-left: 15px;">${item.name}</td>
                                    <td style="text-align: right; padding-right: 10px;">${item.price.toLocaleString()}</td>
                                    <td>${item.quantity}</td>
                                    <td style="text-align: right; font-weight: 700; padding-right: 10px;">${item.amount.toLocaleString()}</td>
                                </tr>
                            `).join('')}
                            ${Array(Math.max(0, 8 - quote.items.length)).fill(0).map(() => `
                                <tr>
                                    <td>&nbsp;</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <div class="total-section">
                        <div class="total-row">
                            <span class="label">Í∏à Ïï°</span>
                            <span>${quote.subtotal.toLocaleString()} Ïõê</span>
                        </div>
                        <div class="total-row">
                            <span class="label">Î∂ÄÍ∞ÄÏÑ∏</span>
                            <span>${quote.vat.toLocaleString()} Ïõê</span>
                        </div>
                        <div class="total-row grand">
                            <span class="label">Ìï© Í≥Ñ</span>
                            <span>${quote.grandTotal.toLocaleString()} Ïõê</span>
                        </div>
                    </div>
                    
                    ${quote.notes ? `<div style="margin-top: 25px; padding: 15px; background: #f9f9f9; border: 1px solid #ddd;"><strong style="font-size: 14px;">‚Äª ÎπÑÍ≥†:</strong><br/><span style="font-size: 13px; line-height: 1.8;">${quote.notes}</span></div>` : ''}
                    
                    <div class="footer">
                        <div class="company-info">
                            <div class="logo-container">
                                <img src="../assets/logo.png" alt="Îã§ÏÜîÎ¨ºÌôòÍ≤ΩÏó∞Íµ¨ÏÜå Î°úÍ≥†" />
                            </div>
                            <div class="company-details">
                                <div class="company-name">Ï£ºÏãùÌöåÏÇ¨ Îã§ÏÜîÎ¨ºÌôòÍ≤ΩÏó∞Íµ¨ÏÜå</div>
                                <div>Í≤ΩÍ∏∞ÎèÑ ÌïòÎÇ®Ïãú Ï¥àÍ¥ëÏÇ∞Îã®Î°ú 126, Ïö∞ÏùºÎπåÎî© 3Ï∏µ</div>
                                <div>Tel. 031-772-4530 | Fax. 070-8677-0553</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="no-print" style="margin-top: 30px; text-align: center;">
                        <button onclick="window.print()" style="padding: 12px 24px; background: #667eea; color: white; border: none; border-radius: 8px; font-size: 14px; cursor: pointer; margin-right: 10px; font-weight: 600;">üñ®Ô∏è Ïù∏ÏáÑ</button>
                        <button onclick="window.close()" style="padding: 12px 24px; background: #6b7280; color: white; border: none; border-radius: 8px; font-size: 14px; cursor: pointer; font-weight: 600;">Îã´Í∏∞</button>
                    </div>
                </body>
                </html>
            `;
            
            const printWindow = window.open('', '_blank', 'width=900,height=800');
            printWindow.document.write(html);
            printWindow.document.close();
        }

        function convertNumberToKorean(num) {
            const units = ['', 'Îßå', 'Ïñµ', 'Ï°∞'];
            const nums = ['', 'Ïùº', 'Ïù¥', 'ÏÇº', 'ÏÇ¨', 'Ïò§', 'Ïú°', 'Ïπ†', 'Ìåî', 'Íµ¨'];
            const positions = ['', 'Ïã≠', 'Î∞±', 'Ï≤ú'];
            
            if (num === 0) return 'ÏòÅ';
            
            let result = '';
            let unitIndex = 0;
            
            while (num > 0) {
                const part = num % 10000;
                if (part > 0) {
                    let partStr = '';
                    let tempPart = part;
                    let posIndex = 0;
                    
                    while (tempPart > 0) {
                        const digit = tempPart % 10;
                        if (digit > 0) {
                            partStr = nums[digit] + positions[posIndex] + partStr;
                        }
                        tempPart = Math.floor(tempPart / 10);
                        posIndex++;
                    }
                    
                    result = partStr + units[unitIndex] + result;
                }
                num = Math.floor(num / 10000);
                unitIndex++;
            }
            
            return result;
        }

        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR');
        }

        init();
    </script>
</body>
</html>
